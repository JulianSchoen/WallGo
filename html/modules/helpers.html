

<!DOCTYPE html>
<html class="writer-html5" lang="Python" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Helpers &mdash; WallGo  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=1e580bb1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hydrodynamics" href="hydrodynamics.html" />
    <link rel="prev" title="Grid3Scales" href="grid3Scales.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #efefef" >

          
          
          <a href="../index.html">
            
              <img src="../_static/wallgo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../firstExample.html">First example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Collected examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">FAQs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="boltzmann.html">BoltzmannSolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="collisionArray.html">CollisionArray</a></li>
<li class="toctree-l1"><a class="reference internal" href="collisionHelpers.html">Collision Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="effectivePotential.html">EffectivePotential</a></li>
<li class="toctree-l1"><a class="reference internal" href="equationOfMotion.html">EOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="fields.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="freeEnergy.html">FreeEnergy</a></li>
<li class="toctree-l1"><a class="reference internal" href="genericModel.html">GenericModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="grid.html">Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="grid3Scales.html">Grid3Scales</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="hydrodynamics.html">Hydrodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="hydrodynamicsTemplateModel.html">HydrodynamicsTemplateModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolatableFunction.html">InterpolatableFunction</a></li>
<li class="toctree-l1"><a class="reference internal" href="manager.html">WallGoManager</a></li>
<li class="toctree-l1"><a class="reference internal" href="particle.html">Particle</a></li>
<li class="toctree-l1"><a class="reference internal" href="polynomial.html">Polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="results.html">Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermodynamics.html">Thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">WallGoUtils</a></li>
<li class="toctree-l1"><a class="reference internal" href="potentialTools/effectivePotentialNoResum.html">PotentialTools.EffectivePotentialNoResum</a></li>
<li class="toctree-l1"><a class="reference internal" href="potentialTools/integrals.html">PotentialTools.Integrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="potentialTools/utilities.html">PotentialTools.Utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #efefef" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WallGo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Helpers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/helpers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-WallGo.helpers">
<span id="helpers"></span><h1>Helpers<a class="headerlink" href="#module-WallGo.helpers" title="Link to this heading"></a></h1>
<p>Helper functions that are used by WallGo.
This includes the derivative functions, a function to compute the step size for solving
detonations and other small functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="WallGo.helpers.boostVelocity">
<span class="sig-prename descclassname"><span class="pre">WallGo.helpers.</span></span><span class="sig-name descname"><span class="pre">boostVelocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/WallGo/helpers.html#boostVelocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#WallGo.helpers.boostVelocity" title="Link to this definition"></a></dt>
<dd><p>Lorentz-transformed velocity</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="WallGo.helpers.derivative">
<span class="sig-prename descclassname"><span class="pre">WallGo.helpers.</span></span><span class="sig-name descname"><span class="pre">derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/WallGo/helpers.html#derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#WallGo.helpers.derivative" title="Link to this definition"></a></dt>
<dd><p>Computes numerical derivatives of a callable function. Use the epsilon
and scale parameters to estimate the optimal value of dx, if the latter is
not provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>function</em>) -- Function to differentiate. Should take a float or an array as argument
and return a float or array (the returned array can have a different
shape as the input, but the first axis must match).</p></li>
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>array-like</em>) -- The position at which to evaluate the derivative.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) -- The number of derivatives to take. Can be 0, 1, 2. The default is 1.</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) -- The accuracy order of the scheme. Errors are of order
<span class="math notranslate nohighlight">\(\mathcal{O}({\rm d}x^{\text{order}/(\text{order+n})})\)</span>. Can be 2 or 4.
Note that the order at the endpoints is reduced by 1 as it would require
more function evaluations to keep the same order. The default is 4.</p></li>
<li><p><strong>bounds</strong> (<em>tuple</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- Interval in which f can be called. If None, can be evaluated anywhere.
The default is None.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) -- Fractional accuracy at which f can be evaluated. If f is a simple
function, should be close to the machine precision. Default is 1e-16.</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) -- Typical scale at which f(x) change by order 1. Default is 1.</p></li>
<li><p><strong>dx</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- The magnitude of finite differences. If None, use epsilon and scale to
estimate the optimal dx. Default is None.</p></li>
<li><p><strong>args</strong> (<em>list</em><em>, </em><em>optional</em>) -- List of other fixed arguments passed to the function <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>res</strong> -- The value of the derivative of <code class="xref py py-data docutils literal notranslate"><span class="pre">f</span></code> evaluated at <code class="xref py py-data docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="WallGo.helpers.gammaSq">
<span class="sig-prename descclassname"><span class="pre">WallGo.helpers.</span></span><span class="sig-name descname"><span class="pre">gammaSq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/WallGo/helpers.html#gammaSq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#WallGo.helpers.gammaSq" title="Link to this definition"></a></dt>
<dd><p>Lorentz factor <span class="math notranslate nohighlight">\(\gamma^2\)</span> corresponding to velocity <span class="math notranslate nohighlight">\(v\)</span></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="WallGo.helpers.gradient">
<span class="sig-prename descclassname"><span class="pre">WallGo.helpers.</span></span><span class="sig-name descname"><span class="pre">gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/WallGo/helpers.html#gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#WallGo.helpers.gradient" title="Link to this definition"></a></dt>
<dd><p>Computes the gradient of a callable function. Use the epsilon
and scale parameters to estimate the optimal value of dx, if the latter is
not provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>function</em>) -- Function to differentiate. Should take an array as argument
and return an array.</p></li>
<li><p><strong>x</strong> (<em>array-like</em>) -- The position at which to evaluate the derivative. The size of the last
axis must correspond to the number of variables on which f depends.</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) -- The accuracy order of the scheme. Errors are of order
<span class="math notranslate nohighlight">\(\mathcal{O}({\rm d}x^{\text{order}/(\text{order}+1)})\)</span>.
Can be 2 or 4. The default is 4.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) -- Fractional accuracy at which f can be evaluated. If f is a simple
function, should be close to the machine precision. Default is 1e-16.</p></li>
<li><p><strong>scale</strong> (<em>float</em><em> or </em><em>array-like</em><em>, </em><em>optional</em>) -- Typical scale at which f(x) change by order 1. Can be an array, in which
case each element corresponds to the scale of a different variable.
Default is 1.</p></li>
<li><p><strong>dx</strong> (<em>float</em><em> or </em><em>np.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- The magnitude of finite differences. Can be an array, in which case
each element corresponds to the dx of a different variable.If None, use
epsilon and scale to estimate the optimal dx. Default is None.</p></li>
<li><p><strong>axis</strong> (<em>list</em><em>, </em><em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- Element of the gradient to return. If None, returns the whole gradient.
Default is None.</p></li>
<li><p><strong>args</strong> (<em>list</em><em>, </em><em>optional</em>) -- List of other fixed arguments passed to the function <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>res</strong> -- The value of the gradient of <code class="xref py py-data docutils literal notranslate"><span class="pre">f</span></code> evaluated at <code class="xref py py-data docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="WallGo.helpers.hessian">
<span class="sig-prename descclassname"><span class="pre">WallGo.helpers.</span></span><span class="sig-name descname"><span class="pre">hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xAxis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yAxis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/WallGo/helpers.html#hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#WallGo.helpers.hessian" title="Link to this definition"></a></dt>
<dd><p>Computes the hessian of a callable function. Use the epsilon
and scale parameters to estimate the optimal value of dx, if the latter is
not provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>function</em>) -- Function to differentiate. Should take an array as argument
and return an array.</p></li>
<li><p><strong>x</strong> (<em>array-like</em>) -- The position at which to evaluate the derivative. The size of the last
axis must correspond to the number of variables on which f depends.</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) -- The accuracy order of the scheme. Errors are of order
<span class="math notranslate nohighlight">\(\mathcal{O}({\rm d}x^{\text{order}/(\text{order}+2)})\)</span>.
Can be 2 or 4. The default is 4.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) -- Fractional accuracy at which f can be evaluated. If f is a simple
function, should be close to the machine precision. Default is 1e-16.</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) -- Typical scale at which f(x) change by order 1. Default is 1.</p></li>
<li><p><strong>dx</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- The magnitude of finite differences. If None, use epsilon and scale to
estimate the optimal dx. Default is None.</p></li>
<li><p><strong>xAxis</strong> (<em>list</em><em>, </em><em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- Lines of the hessian matrix to return. If None, returns all the lines.
Default is None.</p></li>
<li><p><strong>yAxis</strong> (<em>list</em><em>, </em><em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- Columns of the hessian matrix to return. If None, returns all the columns.
Default is None.</p></li>
<li><p><strong>args</strong> (<em>list</em><em>, </em><em>optional</em>) -- List of other fixed arguments passed to the function <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>res</strong> -- The value of the hessian of <code class="xref py py-data docutils literal notranslate"><span class="pre">f</span></code> evaluated at <code class="xref py py-data docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="WallGo.helpers.nextStepDeton">
<span class="sig-prename descclassname"><span class="pre">WallGo.helpers.</span></span><span class="sig-name descname"><span class="pre">nextStepDeton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean2ndDeriv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std2ndDeriv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressureTol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posMax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overshootProb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/WallGo/helpers.html#nextStepDeton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#WallGo.helpers.nextStepDeton" title="Link to this definition"></a></dt>
<dd><p>Function used in EquationOfMotion to find detonation solutions. It finds the next
point to be sampled to try to bracket a root in such a way that the probability of
overshooting a root is roughly equal to overshootProb.</p>
<p>To estimate the overshoot probability, it fits the pressure to a quadratic which is
equal to pressure2 at pos2, but with uncertain 1st and 2nd derivatives which are
assumed to be normally distributed. The mean of the 1st derivative is computed by
finite differences from the last 2 points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos1</strong> (<em>float</em>) -- Position of the first sampled point.</p></li>
<li><p><strong>pos2</strong> (<em>float</em>) -- position of the second sampled point.</p></li>
<li><p><strong>pressure1</strong> (<em>float</em>) -- Pressure at pos1.</p></li>
<li><p><strong>pressure2</strong> (<em>float</em>) -- Pressure at pos2.</p></li>
<li><p><strong>mean2ndDeriv</strong> (<em>float</em>) -- Estimate of the 2nd derivative at pos2.</p></li>
<li><p><strong>std2ndDeriv</strong> (<em>float</em>) -- Uncertainty on the 2nd derivative at pos2.</p></li>
<li><p><strong>pressureTol</strong> (<em>float</em>) -- Relative accuracy at which pressure1 and pressure2 are computed.</p></li>
<li><p><strong>posMax</strong> (<em>float</em>) -- Maximal position that the next step can have.</p></li>
<li><p><strong>overshootProb</strong> (<em>float</em><em>, </em><em>optional</em>) -- Desired overshoot probability. A smaller value will lead to smaller step sizes
which will take longer to evaluate, but with less chances of missing a root.
The default is 0.05.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Position where the overshoot probability is overshootProb (or posMax if there is
no solution).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="grid3Scales.html" class="btn btn-neutral float-left" title="Grid3Scales" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hydrodynamics.html" class="btn btn-neutral float-right" title="Hydrodynamics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Andreas Ekstedt, Oliver Gould, Joonas Hirvonen, Benoit Laurent, Lauri Niemi, Philipp Schicho, and Jorinde van de Vis.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>